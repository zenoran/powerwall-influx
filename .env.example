# Example configuration for powerwall_service
#
# Copy this file to `.env` (same directory) and adjust the values to match
# your environment. All variables can also be supplied directly via the environment
# when invoking the service.

# InfluxDB target (required)
INFLUX_URL=http://influxdb.home:8086
INFLUX_ORG=homeassistant
INFLUX_BUCKET=powerwall
INFLUX_TOKEN=your-influxdb-token-here
INFLUX_MEASUREMENT=powerwall
INFLUX_TIMEOUT=10
INFLUX_VERIFY_TLS=false

# Polling cadence (seconds)
# Polling interval in seconds (how often to query and write to InfluxDB)
PW_POLL_INTERVAL=5

# Powerwall gateway access
PW_HOST=192.168.91.1
PW_TIMEZONE=America/New_York
PW_CACHE_EXPIRE=5
PW_REQUEST_TIMEOUT=10

# Customer or installer credentials (set the ones you have)
PW_CUSTOMER_EMAIL=
PW_CUSTOMER_PASSWORD=
# If you have the gateway password, provide it here (optional but recommended)
PW_GATEWAY_PASSWORD=your-gateway-password

# Optional Wi-Fi management (requires NetworkManager and nmcli)
PW_CONNECT_WIFI=true
PW_WIFI_SSID=TeslaPW_XXXXXX
PW_WIFI_PASSWORD=your-wifi-password
PW_WIFI_INTERFACE=wlp0s20f3

# Logging level: DEBUG, INFO, WARNING, ERROR
PW_LOG_LEVEL=INFO

# MQTT Publishing (optional - for Home Assistant instant sensors)
MQTT_ENABLED=false
MQTT_HOST=mqtt.home
MQTT_PORT=1883
MQTT_USERNAME=
MQTT_PASSWORD=
MQTT_TOPIC_PREFIX=homeassistant/sensor/powerwall
MQTT_QOS=1
MQTT_RETAIN=true
# Comma-separated list of metrics to publish to MQTT (empty = publish all)
# Example: battery_percentage,battery_power_w,solar_power_w,string_a_voltage_v
MQTT_METRICS=

# MQTT Health Monitoring (optional - independent service health tracking)
# Publishes service health status to MQTT for Home Assistant automations
# This runs independently from main service - continues even if Powerwall/InfluxDB fail
MQTT_HEALTH_ENABLED=true
# Health monitoring defaults to main MQTT settings if not specified
MQTT_HEALTH_HOST=mqtt.home
MQTT_HEALTH_PORT=1883
MQTT_HEALTH_USERNAME=
MQTT_HEALTH_PASSWORD=
MQTT_HEALTH_TOPIC_PREFIX=homeassistant/sensor/powerwall_health
MQTT_HEALTH_INTERVAL=60
MQTT_HEALTH_QOS=1


